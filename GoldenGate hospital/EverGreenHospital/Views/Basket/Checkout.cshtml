
@using Evergreen_Persistence.DAL
@using Microsoft.Extensions.Options

@model OrderVm
@inject IOptions<StripeSettings> Stripe
@{
    double Total = 0;
}

<!-- Start -->
<section class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-5 col-lg-4 order-md-last">
                <div class="card rounded shadow p-4 border-0">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span class="h5 mb-0">Your cart</span>

                    </div>
                    <ul class="list-group mb-3 border">
                        @foreach (var item in ViewBag.BasketItems)
                        {
                            Total += item.Count * item.Price;
                            <li class="d-flex justify-content-between lh-sm p-3 border-bottom">
                                <div>
                                    <h6 class="my-0">
                                        @item.Product.Name<strong class="product-quantity">
                                            × @item.Count
                                        </strong>
                                    </h6>
                                    <small class="text-muted">@item.Product.Description</small>
                                </div>
                                <span class="text-muted">$@(item.Count * item.Price)</span>
                            </li>
                        }

                        <li class="d-flex justify-content-between p-3">
                            <span>Total (USD)</span>
                            <strong>$@Total</strong>
                        </li>
                    </ul>
                </div>
            </div><!--end col-->

            <div class="col-md-7 col-lg-8">
                <div class="card rounded shadow p-4 border-0">
                    <h5 class="mb-3">Billing address</h5>
                    @if (ViewBag.BasketItems.Count > 0)
                    {
                        <form method="post"   onchange="this.form.submit()">
                            <div class="row g-3">
                                
                                <div class="col-12">
                                    <label asp-for="Adress" class="form-label">Address</label>
                                    <input asp-for="Adress" class="form-control"
                                           required>
                                    <div class="invalid-feedback">
                                        Please enter your shipping address.
                                    </div>
								</div> 
                                <script src="//checkout.stripe.com/v2/checkout.js"
										class="stripe-button"
										data-key="@Stripe.Value.Publishablekey"
										data-amount="@ViewBag.Total"
										data-name="[Deveducate]"
										data-locale="en"
										data-discription="Sample charge"
										data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
										data-zip-code="true">
								</script>


							</div>
                           
                        </form>
                    }
                </div>
            </div><!--end col-->
        </div><!--end row-->
    </div><!--end container-->
</section><!--end section-->
<!-- End -->
